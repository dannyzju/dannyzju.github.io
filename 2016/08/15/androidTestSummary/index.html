<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"dannyzhang.run","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="敢为常语谈何易，百炼工纯始自然。在软件开发中，完备的测试是防御软件缺陷的第一道也是最好的一道防线。 1. Test Types1.1. Based on Running Platform1.1.1. Local Unit TestsLocated at module-name&#x2F;src&#x2F;test&#x2F;java&#x2F;These tests run on the local JVM and do not hav">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 测试专题笔记">
<meta property="og:url" content="http://dannyzhang.run/2016/08/15/androidTestSummary/index.html">
<meta property="og:site_name" content="D.Z. Notes (Beta)">
<meta property="og:description" content="敢为常语谈何易，百炼工纯始自然。在软件开发中，完备的测试是防御软件缺陷的第一道也是最好的一道防线。 1. Test Types1.1. Based on Running Platform1.1.1. Local Unit TestsLocated at module-name&#x2F;src&#x2F;test&#x2F;java&#x2F;These tests run on the local JVM and do not hav">
<meta property="article:published_time" content="2016-08-15T07:11:49.000Z">
<meta property="article:modified_time" content="2016-08-25T07:35:53.000Z">
<meta property="article:author" content="Danny Zhang">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://dannyzhang.run/2016/08/15/androidTestSummary/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Android 测试专题笔记 | D.Z. Notes (Beta)</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">D.Z. Notes (Beta)</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Be insensitive, and keep a lifelong growth mindset.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://dannyzhang.run/2016/08/15/androidTestSummary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Danny Zhang">
      <meta itemprop="description" content="Blogger/Software Engineer/Fitness Enthusiast">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="D.Z. Notes (Beta)">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Android 测试专题笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-08-15 00:11:49" itemprop="dateCreated datePublished" datetime="2016-08-15T00:11:49-07:00">2016-08-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-08-25 00:35:53" itemprop="dateModified" datetime="2016-08-25T00:35:53-07:00">2016-08-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>敢为常语谈何易，百炼工纯始自然。在软件开发中，完备的测试是防御软件缺陷的第一道也是最好的一道防线。</p>
<h2 id="1-Test-Types"><a href="#1-Test-Types" class="headerlink" title="1. Test Types"></a>1. Test Types</h2><h3 id="1-1-Based-on-Running-Platform"><a href="#1-1-Based-on-Running-Platform" class="headerlink" title="1.1. Based on Running Platform"></a>1.1. Based on Running Platform</h3><h4 id="1-1-1-Local-Unit-Tests"><a href="#1-1-1-Local-Unit-Tests" class="headerlink" title="1.1.1. Local Unit Tests"></a>1.1.1. Local Unit Tests</h4><p>Located at <code>module-name/src/test/java/</code><br>These tests run on the local JVM and do not have access to functional Android framework APIs.</p>
<h4 id="1-1-2-Instrumented-Tests"><a href="#1-1-2-Instrumented-Tests" class="headerlink" title="1.1.2. Instrumented Tests"></a>1.1.2. Instrumented Tests</h4><p>Located at <code>module-name/src/androidTest/java/</code><br>These are all tests that must run on an Android hardware device or an Android emulator.</p>
<ul>
<li><strong>Instrumented Unit Test:</strong> Build complex unit tests with Android dependencies that cannot be satisfied with mock objects.</li>
<li><strong>User Interface Tests:</strong> Create tests to verify that the user interface behaves correctly for user interactions within a single app or for interactions across multiple apps.</li>
<li><strong>App Component Integrations Test:</strong> Verify the behavior of components that users do not directly interact with, such as a Service or a Content Provider.</li>
</ul>
<h3 id="1-2-Based-on-Real-Testing-Types"><a href="#1-2-Based-on-Real-Testing-Types" class="headerlink" title="1.2. Based on Real Testing Types"></a>1.2. Based on Real Testing Types</h3><h4 id="1-2-1-Unit-Tests"><a href="#1-2-1-Unit-Tests" class="headerlink" title="1.2.1. Unit Tests"></a>1.2.1. Unit Tests</h4><ul>
<li><strong>Local Unit Tests:</strong>  Unit tests that run locally on the Java Virtual Machine (JVM). Use these tests to minimize execution time when your tests have no Android framework dependencies or when you can mock the Android framework dependencies.</li>
<li><strong>Instrumented Unit Tests:</strong> Unit tests that run on an Android device or emulator. These tests have access to Instrumentation information, such as the Context of the app you are testing. Use these tests when your tests have Android dependencies that mock objects cannot satisfy.</li>
</ul>
<h4 id="1-2-2-Integration-Tests"><a href="#1-2-2-Integration-Tests" class="headerlink" title="1.2.2. Integration Tests"></a>1.2.2. Integration Tests</h4><ul>
<li><strong>Components within your app only:</strong> This type of test verifies that the target app behaves as expected when a user performs a specific action or enters a specific input in its activities. Supported by <a href="https://developer.android.com/tools/testing-support-library/index.html#Espresso" target="_blank" rel="noopener">Espresso</a>.</li>
<li><strong>Cross-app Components:</strong> This type of test verifies the correct behavior of interactions between different user apps or between user apps and system apps. Supported by <a href="https://developer.android.com/topic/libraries/testing-support-library/index.html#UIAutomator" target="_blank" rel="noopener">UI Automator</a>.</li>
</ul>
<h2 id="2-Set-Up-Testing-Environment"><a href="#2-Set-Up-Testing-Environment" class="headerlink" title="2. Set Up Testing Environment"></a>2. Set Up Testing Environment</h2><h3 id="2-1-Local-Unit-Tests"><a href="#2-1-Local-Unit-Tests" class="headerlink" title="2.1. Local Unit Tests"></a>2.1. Local Unit Tests</h3><p>In your app’s top-level <code>build.gradle</code> file, you need to specify theres libraries as dependencies:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    &#x2F;&#x2F; Required -- JUnit 4 framework</span><br><span class="line">    testCompile &#39;junit:junit:4.12&#39;</span><br><span class="line">    &#x2F;&#x2F; Optional -- Mockito framework</span><br><span class="line">    testCompile &#39;org.mockito:mockito-core:1.10.19&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-Instrumented-Tests"><a href="#2-2-Instrumented-Tests" class="headerlink" title="2.2. Instrumented Tests"></a>2.2. Instrumented Tests</h3><p>In your app’s top-level build.gradle file, you need to specify these libraries as dependencies:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    androidTestCompile &#39;com.android.support:support-annotations:24.0.0&#39;</span><br><span class="line">    androidTestCompile &#39;com.android.support.test:runner:0.5&#39;</span><br><span class="line">    androidTestCompile &#39;com.android.support.test:rules:0.5&#39;</span><br><span class="line">    &#x2F;&#x2F; Optional -- Hamcrest library</span><br><span class="line">    androidTestCompile &#39;org.hamcrest:hamcrest-library:1.3&#39;</span><br><span class="line">    &#x2F;&#x2F; Optional -- UI testing with Espresso</span><br><span class="line">    androidTestCompile &#39;com.android.support.test.espresso:espresso-core:2.2.2&#39;</span><br><span class="line">    &#x2F;&#x2F; Optional -- UI testing with UI Automator</span><br><span class="line">    androidTestCompile &#39;com.android.support.test.uiautomator:uiautomator-v18:2.1.2&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To use JUnit 4 test classes, make sure to specify AndroidJUnitRunner as the default test instrumentation runner in your project by including the following setting in your app’s module-level build.gradle file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-Create-Test-Casese"><a href="#3-Create-Test-Casese" class="headerlink" title="3. Create Test Casese"></a>3. Create Test Casese</h2><h3 id="3-1-Local-Unit-Test-Class"><a href="#3-1-Local-Unit-Test-Class" class="headerlink" title="3.1. Local Unit Test Class"></a>3.1. Local Unit Test Class</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import org.junit.Test;</span><br><span class="line">import java.util.regex.Pattern;</span><br><span class="line">import static org.junit.Assert.assertFalse;</span><br><span class="line">import static org.junit.Assert.assertTrue;</span><br><span class="line"></span><br><span class="line">public class EmailValidatorTest &#123;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void emailValidator_CorrectEmailSimple_ReturnsTrue() &#123;</span><br><span class="line">        assertThat(EmailValidator.isValidEmail(&quot;name@email.com&quot;), is(true));</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To test that components in your app return the expected results, use the junit.Assert methods to perform validation checks (or assertions) to compare the state of the component under test against some expected value. To make tests more readable, you can use Hamcrest matchers (such as the is() and equalTo() methods) to match the returned result against the expected result.</p>
<p><strong>Mock Android dependencies</strong><br>You can use a mocking framework to stub out external dependencies in your code, to easily test that your component interacts with a dependency in an expected way. By substituting Android dependencies with mock objects, you can isolate your unit test from the rest of the Android system while verifying that the correct methods in those dependencies are called. </p>
<p>The <a href="https://github.com/mockito/mockito" target="_blank" rel="noopener">Mockito</a> mocking framework for Java (version 1.9.5 and higher) offers compatibility with Android unit testing. With Mockito, you can configure mock objects to return some specific value when invoked.</p>
<p>Steps to add a mock object to your local unit test:</p>
<ol>
<li>Include the Mockito library dependency in your build.gradle file, as described in Section 2.1.</li>
<li>At the beginning of your unit test class definition, add the <code>@RunWith(MockitoJUnitRunner.class)</code> annotation. This annotation tells the Mockito test runner to validate that your usage of the framework is correct and simplifies the initialization of your mock objects.</li>
<li>To create a mock object for an Android dependency, add the <code>@Mock</code> annotation before the field declaration.</li>
<li>To stub the behavior of the dependency, you can specify a condition and return value when the condition is met by using the <code>when()</code> and <code>thenReturn()</code> methods.</li>
</ol>
<p><strong><em>Code Example:</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(MockitoJUnitRunner.class)</span><br><span class="line">public class UnitTestSample &#123;</span><br><span class="line"></span><br><span class="line">    private static final String FAKE_STRING &#x3D; &quot;HELLO WORLD&quot;;</span><br><span class="line"></span><br><span class="line">    @Mock</span><br><span class="line">    Context mMockContext;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void readStringFromContext_LocalizedString() &#123;</span><br><span class="line">        &#x2F;&#x2F; Given a mocked Context injected into the object under test...</span><br><span class="line">        when(mMockContext.getString(R.string.hello_word))</span><br><span class="line">                .thenReturn(FAKE_STRING);</span><br><span class="line">        ClassUnderTest myObjectUnderTest &#x3D; new ClassUnderTest(mMockContext);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; ...when the string is returned from the object under test...</span><br><span class="line">        String result &#x3D; myObjectUnderTest.getHelloWorldString();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; ...then the result should be the expected one.</span><br><span class="line">        assertThat(result, is(FAKE_STRING));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-Instrumented-Unit-Test-Class"><a href="#3-2-Instrumented-Unit-Test-Class" class="headerlink" title="3.2.  Instrumented Unit Test Class"></a>3.2.  Instrumented Unit Test Class</h3><p>To create an instrumented JUnit 4 test class, add the <code>@RunWith(AndroidJUnit4.class)</code> annotation at the beginning of your test class definition. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import android.os.Parcel;</span><br><span class="line">import android.support.test.runner.AndroidJUnit4;</span><br><span class="line">import android.util.Pair;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.junit.runner.RunWith;</span><br><span class="line">import java.util.List;</span><br><span class="line">import static org.hamcrest.Matchers.is;</span><br><span class="line">import static org.junit.Assert.assertThat;</span><br><span class="line"></span><br><span class="line">@RunWith(AndroidJUnit4.class)</span><br><span class="line">@SmallTest</span><br><span class="line">public class LogHistoryAndroidUnitTest &#123;</span><br><span class="line"></span><br><span class="line">    public static final String TEST_STRING &#x3D; &quot;This is a string&quot;;</span><br><span class="line">    public static final long TEST_LONG &#x3D; 12345678L;</span><br><span class="line">    private LogHistory mLogHistory;</span><br><span class="line"></span><br><span class="line">    @Before</span><br><span class="line">    public void createLogHistory() &#123;</span><br><span class="line">        mLogHistory &#x3D; new LogHistory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void logHistory_ParcelableWriteRead() &#123;</span><br><span class="line">        &#x2F;&#x2F; Set up the Parcelable object to send and receive.</span><br><span class="line">        mLogHistory.addEntry(TEST_STRING, TEST_LONG);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Write the data.</span><br><span class="line">        Parcel parcel &#x3D; Parcel.obtain();</span><br><span class="line">        mLogHistory.writeToParcel(parcel, mLogHistory.describeContents());</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; After you&#39;re done with writing, you need to reset the parcel for reading.</span><br><span class="line">        parcel.setDataPosition(0);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Read the data.</span><br><span class="line">        LogHistory createdFromParcel &#x3D; LogHistory.CREATOR.createFromParcel(parcel);</span><br><span class="line">        List&lt;Pair&lt;String, Long&gt;&gt; createdFromParcelData &#x3D; createdFromParcel.getData();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Verify that the received data is correct.</span><br><span class="line">        assertThat(createdFromParcelData.size(), is(1));</span><br><span class="line">        assertThat(createdFromParcelData.get(0).first, is(TEST_STRING));</span><br><span class="line">        assertThat(createdFromParcelData.get(0).second, is(TEST_LONG));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-Create-an-Espresso-Test-Class"><a href="#3-3-Create-an-Espresso-Test-Class" class="headerlink" title="3.3.  Create an Espresso Test Class"></a>3.3.  Create an Espresso Test Class</h3><p>The following code snippet shows how your test class might invoke this basic workflow:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onView(withId(R.id.my_view))            &#x2F;&#x2F; withId(R.id.my_view) is a ViewMatcher</span><br><span class="line">        .perform(click())               &#x2F;&#x2F; click() is a ViewAction</span><br><span class="line">        .check(matches(isDisplayed())); &#x2F;&#x2F; matches(isDisplayed()) is a ViewAssertion</span><br></pre></td></tr></table></figure>
<h4 id="Using-Espresso-with-ActivityTestRule"><a href="#Using-Espresso-with-ActivityTestRule" class="headerlink" title="Using Espresso with ActivityTestRule"></a>Using Espresso with ActivityTestRule</h4><p>By using ActivityTestRule, the testing framework launches the activity under test before each test method annotated with @Test and before any method annotated with @Before. The framework handles shutting down the activity after the test finishes and all methods annotated with @After are run.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">@RunWith(AndroidJUnit4.class)</span><br><span class="line">@LargeTest</span><br><span class="line">public class ChangeTextBehaviorTest &#123;</span><br><span class="line">    public static final String STRING_TO_BE_TYPED &#x3D; &quot;Espresso&quot;;</span><br><span class="line">    @Rule</span><br><span class="line">    public ActivityTestRule&lt;MainActivity&gt; mActivityRule &#x3D; new ActivityTestRule&lt;&gt;(</span><br><span class="line">            MainActivity.class);</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void changeText_sameActivity() &#123;</span><br><span class="line">        &#x2F;&#x2F; Type text and then press the button.</span><br><span class="line">        onView(withId(R.id.editTextUserInput))</span><br><span class="line">                .perform(typeText(STRING_TO_BE_TYPED), closeSoftKeyboard());</span><br><span class="line">        onView(withId(R.id.changeTextBt)).perform(click());</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Check that the text was changed.</span><br><span class="line">        onView(withId(R.id.textToBeChanged)).check(matches(withText(STRING_TO_BE_TYPED)));</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-Create-an-UI-Automator-Test-Class"><a href="#3-4-Create-an-UI-Automator-Test-Class" class="headerlink" title="3.4. Create an UI Automator Test Class"></a>3.4. Create an UI Automator Test Class</h3><p>… …</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul>
<li><a href="https://developer.android.com/training/testing/start/index.html" target="_blank" rel="noopener">Getting Started with Testing | Android Developers</a></li>
<li><a href="https://developer.android.com/training/testing/unit-testing/index.html" target="_blank" rel="noopener">Building Effective Unit Tests | Android Developers</a></li>
<li><a href="https://developer.android.com/training/testing/ui-testing/index.html" target="_blank" rel="noopener">Automating User Interface Tests | Android Developers</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLWz5rJ2EKKc-6HWg_jyP0U1zrVLHn65b2" target="_blank" rel="noopener">Android Testing Patterns  - YouTube</a></li>
<li><a href="https://google.github.io/android-testing-support-library/docs/index.html" target="_blank" rel="noopener">Espresso Documentation</a></li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Android/" rel="tag"># Android</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2016/08/14/%E7%8F%8D%E6%83%9C%E5%BD%93%E4%B8%8B%EF%BC%8C%E8%8E%AB%E8%B4%9F%E9%9F%B6%E5%8D%8E/" rel="prev" title="珍惜当下，莫负韶华">
      <i class="fa fa-chevron-left"></i> 珍惜当下，莫负韶华
    </a></div>
      <div class="post-nav-item">
    <a href="/2016/08/25/androidThreads/" rel="next" title="Android中的Threads的实现">
      Android中的Threads的实现 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Test-Types"><span class="nav-number">1.</span> <span class="nav-text">1. Test Types</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Based-on-Running-Platform"><span class="nav-number">1.1.</span> <span class="nav-text">1.1. Based on Running Platform</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-Local-Unit-Tests"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1.1. Local Unit Tests</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-Instrumented-Tests"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.1.2. Instrumented Tests</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Based-on-Real-Testing-Types"><span class="nav-number">1.2.</span> <span class="nav-text">1.2. Based on Real Testing Types</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-Unit-Tests"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.2.1. Unit Tests</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-Integration-Tests"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.2.2. Integration Tests</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Set-Up-Testing-Environment"><span class="nav-number">2.</span> <span class="nav-text">2. Set Up Testing Environment</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Local-Unit-Tests"><span class="nav-number">2.1.</span> <span class="nav-text">2.1. Local Unit Tests</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Instrumented-Tests"><span class="nav-number">2.2.</span> <span class="nav-text">2.2. Instrumented Tests</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Create-Test-Casese"><span class="nav-number">3.</span> <span class="nav-text">3. Create Test Casese</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Local-Unit-Test-Class"><span class="nav-number">3.1.</span> <span class="nav-text">3.1. Local Unit Test Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Instrumented-Unit-Test-Class"><span class="nav-number">3.2.</span> <span class="nav-text">3.2.  Instrumented Unit Test Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Create-an-Espresso-Test-Class"><span class="nav-number">3.3.</span> <span class="nav-text">3.3.  Create an Espresso Test Class</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Using-Espresso-with-ActivityTestRule"><span class="nav-number">3.3.1.</span> <span class="nav-text">Using Espresso with ActivityTestRule</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Create-an-UI-Automator-Test-Class"><span class="nav-number">3.4.</span> <span class="nav-text">3.4. Create an UI Automator Test Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#References"><span class="nav-number">3.5.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Danny Zhang</p>
  <div class="site-description" itemprop="description">Blogger/Software Engineer/Fitness Enthusiast</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">47</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">61</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Danny Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
